<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <title>é‹è¡Œç®¡ç†ã‚·ã‚¹ãƒ†ãƒ  v49.8</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body { font-family: sans-serif; background: #f1f5f9; font-size: 11px; color: #000; }
        table { border-collapse: collapse; width: 100%; border: 2px solid black; background: white; }
        th, td { border: 1px solid black; padding: 2px; text-align: center; }
        .label-cell { background: #f3f4f6; font-size: 10px; font-weight: bold; width: 45px; }
        .user-name-select { font-size: 15px !important; font-weight: 900 !important; color: #000; width: 100%; border: none; background: transparent; appearance: none; }
        .school-info { color: #1d4ed8; font-size: 11px; font-weight: bold; display: block; line-height: 1.2; }
        .time-input { background: #fffbeb !important; border: 1px solid #f59e0b !important; font-size: 15px !important; font-weight: bold; width: 100%; text-align: center; }
        .is-absent { background-color: #e5e7eb !important; color: #9ca3af !important; }
        .day-chip { cursor: pointer; padding: 0 4px; border-radius: 2px; font-size: 9px; border: 1px solid #ccc; }
        .day-active { background-color: #2563eb; color: white; border-color: #1e40af; }
        .day-inactive { background-color: #e5e7eb; color: #9ca3af; }
        .self-time-input { background: transparent; border-bottom: 1px solid #3b82f6; width: 40px; text-align: center; color: #1e40af; font-weight: bold; }
        @media print { .no-print { display: none !important; } .print-area { width: 100% !important; border: none !important; margin: 0 !important; padding: 0 !important; } @page { size: A4; margin: 5mm; } }
    </style>
</head>
<body class="min-h-screen">

<script>
    const STORAGE_KEY = 'SHOJIN_V49_MASTER';
    const OFFICE_NAMES = ["æ˜Ÿã®æ‘", "ã‚«ãƒ©ãƒ•ãƒ«", "ãƒ—ãƒªã‚ºãƒ "];
    const toHalf = (s) => s ? String(s).replace(/[ï¼-ï¼™]/g, a => String.fromCharCode(a.charCodeAt(0) - 0xFEE0)) : "";
    const abbrSchool = (s) => s ? s.replace(/å°å­¦æ ¡/g, "å°").replace(/ä¸­å­¦æ ¡/g, "ä¸­").replace(/æ”¯æ´å­¦æ ¡/g, "æ”¯") : "";
    const formatGrade = (g) => { const val = toHalf(g); return /^[1-6]$/.test(val) ? "å°" + val : val; };

    let state = JSON.parse(localStorage.getItem(STORAGE_KEY)) || {
        curIdx: 0, offices: Array(3).fill(null).map(() => ({ u: [], v: [], s: [], r: {}, attendance: {}, phones: [{id:1, label:"Aæºå¸¯", num:""}] }))
    };

    const save = () => { localStorage.setItem(STORAGE_KEY, JSON.stringify(state)); render(); };
    const getCur = () => state.offices[state.curIdx];
    const getDate = () => document.getElementById('dateInput').value;
    const getDay = () => ["æ—¥","æœˆ","ç«","æ°´","æœ¨","é‡‘","åœŸ"][new Date(getDate()).getDay()];

    window.exportData = () => {
        const blob = new Blob([JSON.stringify(state)], {type: 'application/json'});
        const a = document.createElement('a'); a.href = URL.createObjectURL(blob); a.download = `é€è¿ãƒ‡ãƒ¼ã‚¿_${getDate()}.json`; a.click();
    };
    window.importData = (e) => {
        const file = e.target.files[0]; if(!file) return;
        const reader = new FileReader();
        reader.onload = (ev) => { try { state = JSON.parse(ev.target.result); save(); alert('åŒæœŸå®Œäº†'); } catch(err) { alert('å½¢å¼ã‚¨ãƒ©ãƒ¼'); } };
        reader.readAsText(file);
    };

    // CSVå°‚ç”¨ãƒ‘ãƒ¼ã‚µãƒ¼ï¼ˆã‚¯ã‚©ãƒ¼ãƒˆå†…ã®æ”¹è¡Œå¯¾å¿œï¼‰
    function parseCSV(text) {
        const rows = [];
        let row = [];
        let col = "";
        let inQuote = false;
        for (let i = 0; i < text.length; i++) {
            const char = text[i];
            const next = text[i+1];
            if (char === '"' && inQuote && next === '"') { col += '"'; i++; }
            else if (char === '"') { inQuote = !inQuote; }
            else if (char === ',' && !inQuote) { row.push(col); col = ""; }
            else if ((char === '\r' || char === '\n') && !inQuote) {
                if (col !== "" || row.length > 0) {
                    row.push(col); rows.push(row);
                    row = []; col = "";
                }
                if (char === '\r' && next === '\n') i++;
            } else { col += char; }
        }
        if (col !== "" || row.length > 0) { row.push(col); rows.push(row); }
        return rows;
    }

    // CSVèª­ã¿è¾¼ã¿
    window.importCSV = (e) => {
        const file = e.target.files[0]; if(!file) return;
        const reader = new FileReader();
        reader.onload = (ev) => {
            const rows = parseCSV(ev.target.result);
            const cur = getCur();
            let count = 0;

            rows.forEach((cols, i) => {
                if (i === 0 || cols.length < 2) return; // ãƒ˜ãƒƒãƒ€ãƒ¼é£›ã°ã—

                // æ°åæŠ½å‡ºï¼ˆæ”¹è¡ŒãŒã‚ã‚Œã°2è¡Œç›®ï¼æ¼¢å­—ã‚’æ¡ç”¨ï¼‰
                const nameRaw = cols[0] || "";
                const nameLines = nameRaw.split(/\r\n|\n/);
                const name = (nameLines.length > 1 ? nameLines[1] : nameLines[0]).trim();

                // æ›œæ—¥æŠ½å‡º
                const groupRaw = cols[1] || "";
                let days = "";
                ["æœˆ","ç«","æ°´","æœ¨","é‡‘","åœŸ"].forEach(d => { if(groupRaw.includes(d + "æ›œ")) days += d; });

                const school = (cols[3] || "").trim();
                const grade = (cols[4] || "").trim();

                cur.u.push({
                    id: 'ID' + Date.now() + i,
                    name: name || "ä¸æ˜",
                    school: school,
                    grade: grade,
                    inType: 'è»Šä¸¡', outType: 'è»Šä¸¡',
                    inTime: '14:00', outTime: '17:30',
                    days: days || 'æœˆç«æ°´æœ¨é‡‘åœŸ',
                    prefCar: '', masterNote: ''
                });
                count++;
            });
            save(); alert(count + ' åã®ãƒ‡ãƒ¼ã‚¿ã‚’å–ã‚Šè¾¼ã¿ã¾ã—ãŸ');
        };
        // æ˜Ÿã®æ‘.csvã«åˆã‚ã›ã¦Shift-JISã§èª­ã¿è¾¼ã¿
        reader.readAsText(file, 'Shift-JIS');
    };

    const sortMembers = (members) => {
        return members.sort((a, b) => {
            if (!a.time) return 1; if (!b.time) return -1;
            return a.time.localeCompare(b.time);
        });
    };

    window.autoAssign = () => {
        const d = getDate(); const day = getDay(); const cur = getCur();
        const att = cur.attendance[d] || {};
        cur.r[d] = { "è¿ãˆ": [], "é€ã‚Š": [], "selfTimes": {} };
        const vList = cur.v.filter(v => v.days.includes(day));
        ["è¿ãˆ", "é€ã‚Š"].forEach(type => {
            const tp = type === "è¿ãˆ" ? "inType" : "outType";
            const tm = type === "è¿ãˆ" ? "inTime" : "outTime";
            let rem = cur.u.filter(u => u.days.includes(day) && att[u.id] !== 'æ¬ ' && u[tp] === 'è»Šä¸¡');
            cur.r[d][type] = vList.map(v => {
                const rt = { vName: v.name, driver: "", staff: "", phoneNum: "", members: [] };
                rem.filter(u => u.prefCar === v.name).forEach(u => {
                    if(rt.members.length < 8) { rt.members.push({ uId: u.id, time: u[tm] }); rem = rem.filter(x => x.id !== u.id); }
                });
                while(rt.members.length < 8) {
                    const u = rem.shift(); rt.members.push({ uId: u ? u.id : "", time: u ? u[tm] : "" });
                }
                rt.members = sortMembers(rt.members); return rt;
            });
        });
        save();
    };

    window.render = () => {
        const cur = getCur(); const date = getDate(); const day = getDay();
        const att = cur.attendance[date] || {};
        if(!cur.r[date]) cur.r[date] = { "è¿ãˆ":[], "é€ã‚Š":[], "selfTimes":{} };
        if(!cur.r[date].selfTimes) cur.r[date].selfTimes = {};
        document.getElementById('officeTitle').innerText = OFFICE_NAMES[state.curIdx];
        document.getElementById('printDate').innerText = date.replace(/-/g, '/') + ` (${day})`;

        ['è¿ãˆ', 'é€ã‚Š'].forEach(type => {
            const routes = cur.r[date][type] || [];
            document.getElementById(type + 'Area').innerHTML = routes.map((rt, ri) => `
                <div class="mb-1 border-2 border-black relative">
                    <button class="no-print absolute top-0 right-1 text-red-500 font-bold px-1" onclick="getCur().r['${date}']['${type}'].splice(${ri},1);save()">Ã—</button>
                    <table>
                        <tr class="bg-gray-100 font-bold text-[11px]"><td colspan="6" class="text-left px-2 italic">ä¾¿åï¼š<input type="text" class="bg-transparent" value="${rt.vName}" onchange="getCur().r['${date}']['${type}'][${ri}].vName=this.value;save()"></td></tr>
                        <tr><td class="label-cell">é‹è»¢</td><td class="w-24"><select class="w-full text-[11px] font-bold" onchange="getCur().r['${date}']['${type}'][${ri}].driver=this.value;save()"><option value="">--</option>${cur.s.filter(s=>s.days.includes(day)).map(s=>`<option value="${s.name}" ${rt.driver===s.name?'selected':''}>${s.name}</option>`).join('')}</select></td>${[0, 1].map(i => renderCell(date, type, ri, i, rt.members[i], cur, day, att)).join('')}</tr>
                        <tr><td class="label-cell">æ·»ä¹—</td><td><select class="w-full text-[11px] font-bold" onchange="getCur().r['${date}']['${type}'][${ri}].staff=this.value;save()"><option value="">--</option>${cur.s.filter(s=>s.days.includes(day)).map(s=>`<option value="${s.name}" ${rt.staff===s.name?'selected':''}>${s.name}</option>`).join('')}</select></td>${[2, 3].map(i => renderCell(date, type, ri, i, rt.members[i], cur, day, att)).join('')}</tr>
                        <tr><td class="label-cell">é€£çµ¡å…ˆ</td><td class="flex items-center"><select class="no-print w-6 text-[8px]" onchange="getCur().r['${date}']['${type}'][${ri}].phoneNum=this.value;save()"><option value="">é¸</option>${cur.phones.map(p=>`<option value="${p.num}">${p.label}</option>`).join('')}</select><input type="text" class="w-full text-center text-[11px] font-bold" value="${rt.phoneNum}" onchange="getCur().r['${date}']['${type}'][${ri}].phoneNum=this.value;save()"></td>${[4, 5].map(i => renderCell(date, type, ri, i, rt.members[i], cur, day, att)).join('')}</tr>
                        <tr><td class="label-cell">å‚™è€ƒ</td><td></td>${[6, 7].map(i => renderCell(date, type, ri, i, rt.members[i], cur, day, att)).join('')}</tr>
                    </table>
                </div>`).join('');
            const tp = type === "è¿ãˆ" ? "inType" : "outType";
            const tm = type === "è¿ãˆ" ? "inTime" : "outTime";
            const selfs = cur.u.filter(u => u.days.includes(day) && u[tp] !== 'è»Šä¸¡' && att[u.id] !== 'æ¬ ');
            document.getElementById(type + 'Self').innerHTML = selfs.length ? `<span class="text-blue-700 font-bold">ã€è‡ªåŠ›ãƒ»ä¿è­·è€…ã€‘</span> ${selfs.map(u => {
                const ct = cur.r[date].selfTimes[u.id + type] || u[tm];
                return `${u.name}(<input type="text" class="self-time-input" value="${ct}" onchange="getCur().r['${date}'].selfTimes['${u.id}${type}']=toHalf(this.value);save()">)`;
            }).join(', ')}` : '';
        });

        document.getElementById('attendList').innerHTML = cur.u.filter(u => u.days.includes(day)).map((u, idx) => `
            <tr class="h-8 ${att[u.id]==='æ¬ ' ? 'is-absent' : ''}"><td>${idx+1}</td><td class="no-print"><button onclick="const c=getCur(); if(!c.attendance['${date}']) c.attendance['${date}']={}; c.attendance['${date}']['${u.id}']=c.attendance['${date}']['${u.id}']==='æ¬ '?'å‡º':'æ¬ '; save();" class="border px-1 bg-white font-bold">${att[u.id]==='æ¬ '?'æ¬ ':'å‡º'}</button></td><td class="w-24 font-bold text-[13px]">${u.name}</td><td class="text-[10px] w-24">${abbrSchool(u.school)} / ${formatGrade(u.grade)}</td><td class="px-1"><input type="text" class="w-full bg-transparent font-bold text-red-600 text-[11px]" value="${u.note || u.masterNote || ''}"></td></tr>`).join('');
        document.getElementById('staffStatusList').innerHTML = cur.s.filter(s => s.days.includes(day)).map((s, idx) => `<tr class="h-8"><td>${idx+1}</td><td class="font-bold text-[12px]">${s.name}</td><td><input type="text" class="w-24 text-center text-[11px] font-bold" value="${s.todayPhone || ''}" onchange="getCur().s.find(x=>x.id==='${s.id}').todayPhone=this.value;save()"></td></tr>`).join('');
        updateMasterTables(cur);
    };

    function renderCell(date, type, rIdx, mIdx, m, cur, day, att) {
        const u = cur.u.find(x => x.id === (m ? m.uId : ""));
        const tp = type === "è¿ãˆ" ? "inType" : "outType";
        const elg = cur.u.filter(x => x.days.includes(day) && att[x.id] !== 'æ¬ ' && x[tp] === 'è»Šä¸¡');
        return `<td class="w-14"><input type="text" class="time-input" value="${u ? m.time : ''}" onchange="getCur().r['${date}']['${type}'][${rIdx}].members[${mIdx}].time=toHalf(this.value); getCur().r['${date}']['${type}'][${rIdx}].members=sortMembers(getCur().r['${date}']['${type}'][${rIdx}].members); save()"></td>
                <td class="w-36 text-left px-1 border-r border-black"><select class="user-name-select" onchange="const v=this.value; const usr=getCur().u.find(x=>x.id===v); getCur().r['${date}']['${type}'][${rIdx}].members[${mIdx}].uId=v; getCur().r['${date}']['${type}'][${rIdx}].members[${mIdx}].time=usr?(usr['${type==='è¿ãˆ'?'inTime':'outTime'}']):''; getCur().r['${date}']['${type}'][${rIdx}].members=sortMembers(getCur().r['${date}']['${type}'][${rIdx}].members); save()"><option value="">--</option>${elg.map(x=>`<option value="${x.id}" ${u?.id===x.id?'selected':''}>${x.name}</option>`).join('')}</select><span class="school-info">${u ? abbrSchool(u.school) + ' ' + formatGrade(u.grade) : ''}</span></td>`;
    }

    const updateMasterTables = (cur) => {
        const renderDays = (item, type) => ["æœˆ","ç«","æ°´","æœ¨","é‡‘","åœŸ"].map(d => `<span class="day-chip ${item.days.includes(d)?'day-active':'day-inactive'}" onclick="const x=getCur().${type}.find(y=>y.id==='${item.id}'); x.days=x.days.includes('${d}')?x.days.replace('${d}',''):x.days+'${d}';save()">${d}</span>`).join('');
        document.getElementById('userTable').innerHTML = cur.u.map(i => `<tr><td><input type="text" class="w-full" value="${i.name}" onchange="getCur().u.find(x=>x.id==='${i.id}').name=this.value;save()"></td><td><div class="flex gap-0.5">${renderDays(i, 'u')}</div></td><td><input type="text" class="w-full text-[10px]" value="${i.school}" onchange="getCur().u.find(x=>x.id==='${i.id}').school=this.value;save()"></td><td><input type="text" class="w-6" value="${i.grade}" onchange="getCur().u.find(x=>x.id==='${i.id}').grade=this.value;save()"></td><td><select onchange="getCur().u.find(x=>x.id==='${i.id}').inType=this.value;save()"><option value="è»Šä¸¡" ${i.inType==='è»Šä¸¡'?'selected':''}>è»Šä¸¡</option><option value="ä¿è­·è€…" ${i.inType==='ä¿è­·è€…'?'selected':''}>ä¿è­·è€…</option><option value="è‡ªåŠ›" ${i.inType==='è‡ªåŠ›'?'selected':''}>è‡ªåŠ›</option></select></td><td><input type="text" class="w-10" value="${i.inTime}" onchange="getCur().u.find(x=>x.id==='${i.id}').inTime=toHalf(this.value);save()"></td><td><select onchange="getCur().u.find(x=>x.id==='${i.id}').outType=this.value;save()"><option value="è»Šä¸¡" ${i.outType==='è»Šä¸¡'?'selected':''}>è»Šä¸¡</option><option value="ä¿è­·è€…" ${i.outType==='ä¿è­·è€…'?'selected':''}>ä¿è­·è€…</option><option value="è‡ªåŠ›" ${i.outType==='è‡ªåŠ›'?'selected':''}>è‡ªåŠ›</option></select></td><td><input type="text" class="w-10" value="${i.outTime}" onchange="getCur().u.find(x=>x.id==='${i.id}').outTime=toHalf(this.value);save()"></td><td><select class="w-16" onchange="getCur().u.find(x=>x.id==='${i.id}').prefCar=this.value;save()"><option value="">--</option>${cur.v.map(v=>`<option value="${v.name}" ${i.prefCar===v.name?'selected':''}>${v.name}</option>`).join('')}</select></td><td><input type="text" class="w-full text-blue-600 font-bold" value="${i.masterNote||''}" onchange="getCur().u.find(x=>x.id==='${i.id}').masterNote=this.value;save()"></td><td><button class="text-red-500 font-bold" onclick="getCur().u=getCur().u.filter(x=>x.id!=='${i.id}');save()">Ã—</button></td></tr>`).join('');
        const drawST = (type, list) => list.map(i => `<tr><td><input type="text" class="w-full" value="${i.name}" onchange="getCur().${type}.find(x=>x.id==='${i.id}').name=this.value;save()"></td><td><div class="flex gap-0.5">${renderDays(i, type)}</div></td><td><button class="text-red-500 font-bold" onclick="getCur().${type}=getCur().${type}.filter(x=>x.id!=='${i.id}');save()">Ã—</button></td></tr>`).join('');
        document.getElementById('staffTable').innerHTML = drawST('s', cur.s);
        document.getElementById('vehicleTable').innerHTML = drawST('v', cur.v);
        document.getElementById('phoneTable').innerHTML = cur.phones.map(p => `<tr><td><input type="text" class="w-full" value="${p.label}" onchange="getCur().phones.find(x=>x.id===${p.id}).label=this.value;save()"></td><td><input type="text" class="w-full" value="${p.num}" onchange="getCur().phones.find(x=>x.id===${p.id}).num=this.value;save()"></td><td><button class="text-red-500 font-bold" onclick="getCur().phones=getCur().phones.filter(x=>x.id!==${p.id});save()">Ã—</button></td></tr>`).join('');
    };

    window.addMaster = (type) => {
        const cur = getCur(); const id = 'ID'+Date.now();
        if(type==='u') cur.u.push({id, name:'æ–°è¦', school:'', grade:'', inType:'è»Šä¸¡', outType:'è»Šä¸¡', inTime:'', outTime:'', days:'æœˆç«æ°´æœ¨é‡‘åœŸ', prefCar:'', masterNote:''});
        if(type==='s') cur.s.push({id, name:'æ–°è¦è·å“¡', days:'æœˆç«æ°´æœ¨é‡‘åœŸ'});
        if(type==='v') cur.v.push({id, name:'æ–°è¦è»Šä¸¡', days:'æœˆç«æ°´æœ¨é‡‘åœŸ'});
        if(type==='p') cur.phones.push({id:Date.now(), label:'æºå¸¯', num:''});
        save();
    };

    window.onload = () => { const d = new Date(); d.setMinutes(d.getMinutes() - d.getTimezoneOffset()); document.getElementById('dateInput').value = d.toISOString().split('T')[0]; render(); };
</script>

<header class="bg-slate-900 text-white p-2 no-print flex justify-between items-center shadow-lg">
    <div class="flex items-center gap-3">
        <h1 class="text-xl font-black italic text-blue-400">é‹è¡Œç®¡ç† v49.8</h1>
        <div class="flex bg-slate-800 rounded p-1 gap-1">
            <button onclick="state.curIdx=0;save()" class="px-2 hover:bg-slate-600 rounded">æ˜Ÿã®æ‘</button>
            <button onclick="state.curIdx=1;save()" class="px-2 hover:bg-slate-600 rounded">ã‚«ãƒ©ãƒ•ãƒ«</button>
            <button onclick="state.curIdx=2;save()" class="px-2 hover:bg-slate-600 rounded">ãƒ—ãƒªã‚ºãƒ </button>
        </div>
        <input type="date" id="dateInput" onchange="render()" class="text-black px-2 py-1 rounded font-bold">
    </div>
    <div class="flex gap-2">
        <button onclick="exportData()" class="bg-indigo-600 px-3 py-1 rounded font-bold text-[10px]">å…¨ãƒ‡ãƒ¼ã‚¿ä¿å­˜</button>
        <label class="bg-slate-600 px-3 py-1 rounded cursor-pointer text-[10px] font-bold">å…¨ãƒ‡ãƒ¼ã‚¿å–è¾¼<input type="file" onchange="importData(event)" class="hidden"></label>
        <button onclick="autoAssign()" class="bg-orange-600 px-3 py-1 rounded font-bold text-[10px]">è‡ªå‹•ä½œæˆ</button>
        <button onclick="window.print()" class="bg-blue-600 px-6 py-1 rounded font-bold text-[10px]">å°åˆ·</button>
    </div>
</header>

<main class="p-1">
    <div class="max-w-7xl mx-auto p-4 bg-white border-2 border-black min-h-screen print-area shadow-xl">
        <div class="flex justify-between items-end mb-2 border-b-4 border-black pb-1">
            <h2 class="text-3xl font-black italic">ã€<span id="officeTitle"></span>ã€‘ é€è¿é‹è¡Œè¨ˆç”»è¡¨</h2>
            <div id="printDate" class="text-2xl font-black"></div>
        </div>
        <div class="grid grid-cols-12 gap-3">
            <div class="col-span-8">
                <div class="bg-blue-900 text-white px-2 py-0.5 mb-1 font-bold text-[13px] flex justify-between items-center">â–  è¿ãˆä¾¿ <button onclick="const d=getDate(); const cur=getCur(); if(!cur.r[d]) cur.r[d]={'è¿ãˆ':[],'é€ã‚Š':[],'selfTimes':{}}; cur.r[d]['è¿ãˆ'].push({vName:'æ–°è¦ä¾¿',driver:'',staff:'',phoneNum:'',members:Array(8).fill({uId:'',time:''})}); save();" class="no-print bg-white text-blue-900 px-2 rounded text-[10px]">+ ä¾¿è¿½åŠ </button></div>
                <div id="è¿ãˆArea"></div><div id="è¿ãˆSelf" class="mb-4 p-1 border border-black text-[11px] min-h-[1.5em] bg-gray-50 font-bold"></div>
                <div class="bg-red-900 text-white px-2 py-0.5 mb-1 mt-4 font-bold text-[13px] flex justify-between items-center">â–  é€ã‚Šä¾¿ <button onclick="const d=getDate(); const cur=getCur(); if(!cur.r[d]) cur.r[d]={'è¿ãˆ':[],'é€ã‚Š':[],'selfTimes':{}}; cur.r[d]['é€ã‚Š'].push({vName:'æ–°è¦ä¾¿',driver:'',staff:'',phoneNum:'',members:Array(8).fill({uId:'',time:''})}); save();" class="no-print bg-white text-red-900 px-2 rounded text-[10px]">+ ä¾¿è¿½åŠ </button></div>
                <div id="é€ã‚ŠArea"></div><div id="é€ã‚ŠSelf" class="p-1 border border-black text-[11px] min-h-[1.5em] bg-gray-50 font-bold"></div>
            </div>
            <div class="col-span-4 space-y-4">
                <div class="border-2 border-black p-1"><h3 class="bg-black text-white text-center font-bold py-1 mb-1 text-[11px]">ã‚¹ã‚¿ãƒƒãƒ•ä½“åˆ¶</h3><table><tr class="bg-gray-100 text-[10px]"><th>No</th><th>æ°å</th><th>é€£çµ¡å…ˆ</th></tr><tbody id="staffStatusList"></tbody></table></div>
                <div class="border-2 border-black p-1"><h3 class="bg-gray-800 text-white text-center font-bold py-1 mb-1 text-[11px]">å‡ºæ¬ ãƒ»é‡è¦äº‹é …</h3><table><tr class="bg-gray-100 text-[10px]"><th>No</th><th class="no-print">å‡º</th><th>æ°å</th><th>å­¦æ ¡/å­¦å¹´</th><th>ç‰¹è¨˜</th></tr><tbody id="attendList"></tbody></table></div>
            </div>
        </div>
    </div>

    <div class="no-print mt-10 p-6 bg-white border-2 shadow-2xl">
        <h3 class="font-black text-xl border-b-4 border-blue-500 mb-6 text-blue-800 italic">ã‚·ã‚¹ãƒ†ãƒ è¨­å®šï¼ˆãƒã‚¹ã‚¿ç®¡ç†ï¼‰</h3>
        <section class="mb-8">
            <h4 class="font-bold text-sm mb-2 text-red-700">ã€åˆ©ç”¨è€…ãƒã‚¹ã‚¿ã€‘</h4>
            <table class="text-[10px] w-full mb-2"><tr class="bg-gray-700 text-white"><th>æ°å</th><th>é€šæ‰€æ—¥</th><th>å­¦æ ¡å</th><th>å­¦å¹´</th><th>è¿åŒºåˆ†</th><th>è¿æ™‚é–“</th><th>é€åŒºåˆ†</th><th>é€æ™‚é–“</th><th>å„ªå…ˆè»Šä¸¡</th><th>ç‰¹è¨˜</th><th>æ¶ˆ</th></tr><tbody id="userTable"></tbody></table>
            <div class="flex gap-4">
                <button onclick="addMaster('u')" class="flex-1 border-2 border-dashed p-2 bg-gray-50 font-bold hover:bg-blue-50">+ åˆ©ç”¨è€…ã‚’æ‰‹å‹•è¿½åŠ </button>
                <label class="flex-1 border-2 border-dashed p-2 bg-green-50 font-bold hover:bg-green-100 cursor-pointer text-center text-green-800">ğŸ“ CSVã‹ã‚‰ä¸€æ‹¬èª­è¾¼<input type="file" onchange="importCSV(event)" class="hidden" accept=".csv"></label>
            </div>
        </section>
        <div class="grid grid-cols-3 gap-6">
            <section><h4 class="font-bold text-sm mb-2 border-l-4 border-black pl-2">è·å“¡</h4><table id="staffTable" class="text-[10px]"></table><button onclick="addMaster('s')" class="w-full border-2 border-dashed p-1 mt-2">+ è·å“¡è¿½åŠ </button></section>
            <section><h4 class="font-bold text-sm mb-2 border-l-4 border-black pl-2">è»Šä¸¡</h4><table id="vehicleTable" class="text-[10px]"></table><button onclick="addMaster('v')" class="w-full border-2 border-dashed p-1 mt-2">+ è»Šä¸¡è¿½åŠ </button></section>
            <section><h4 class="font-bold text-sm mb-2 border-l-4 border-black pl-2">æºå¸¯ãƒ»é€£çµ¡å…ˆ</h4><table id="phoneTable" class="text-[10px]"></table><button onclick="addMaster('p')" class="w-full border-2 border-dashed p-1 mt-2">+ é€£çµ¡å…ˆè¿½åŠ </button></section>
        </div>
    </div>
</main>
</body>
</html>
