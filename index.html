<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>放課後等デイサービス 送迎管理システム</title>
    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/lucide@latest"></script>
    <style>
        @media print {
            .no-print { display: none !important; }
            body { background: white; }
            .print-area { width: 100%; height: auto; padding: 0; margin: 0; }
            @page { size: A4 landscape; margin: 10mm; }
        }
    </style>
</head>
<body class="bg-gray-50 min-h-screen">
    <div id="root"></div>

    <script type="text/babel">
        // ※ ここにAI Studioで生成された「アプリ.tsx」の中身をReact.js形式に調整して埋め込みます
        // 実際には膨大なコードになるため、ここでは主要な構造を反映した「完成版テンプレート」を提示します
        
        const { useState, useEffect, useMemo } = React;

        const App = () => {
            // 状態管理（事業所、利用者、スタッフ、車両、送迎ルート）
            const [officeName, setOfficeName] = useState("【事業所名】");
            const [users, setUsers] = useState([]);
            const [staffs, setStaffs] = useState([]);
            const [vehicles, setVehicles] = useState([]);
            const [routes, setRoutes] = useState([]);
            const [activeTab, setActiveTab] = useState('schedule');

            // --- ここにAI Studioで作成したロジックを統合 ---
            // 例：学年の変換（中1年 -> 中1）
            const formatGrade = (grade) => grade.replace('年', '');

            // 送迎表の自動作成ロジック（Gemini API呼び出し部分を含む）
            const generateRoutes = async () => {
                // 送迎作成ボタンの機能をここに実装
                console.log("送迎ルートを生成中...");
            };

            return (
                <div class="max-w-7xl mx-auto p-4">
                    <header class="flex justify-between items-center mb-6 no-print">
                        <h1 class="text-2xl font-bold text-blue-800">{officeName} 送迎表作成</h1>
                        <nav class="flex gap-4">
                            <button onClick={() => setActiveTab('schedule')} class={`px-4 py-2 rounded ${activeTab === 'schedule' ? 'bg-blue-600 text-white' : 'bg-white'}`}>送迎表</button>
                            <button onClick={() => setActiveTab('users')} class={`px-4 py-2 rounded ${activeTab === 'users' ? 'bg-blue-600 text-white' : 'bg-white'}`}>利用者管理</button>
                            <button onClick={() => window.print()} class="bg-green-600 text-white px-4 py-2 rounded">印刷(A4横)</button>
                        </nav>
                    </header>

                    {/* タブ切り替えによる各画面の表示 */}
                    <main class="print-area">
                        {activeTab === 'schedule' && (
                            <div class="grid grid-cols-3 gap-4">
                                {/* ここに送迎ルート、出欠管理、スタッフ体制を配置 */}
                                <div class="col-span-2 bg-white p-4 shadow rounded">
                                    <h2 class="font-bold border-b mb-2">送迎ルート（車両別）</h2>
                                    {/* 車両ごとのリスト */}
                                </div>
                                <div class="bg-white p-4 shadow rounded">
                                    <h2 class="font-bold border-b mb-2">出欠・学校状況</h2>
                                    {/* 氏名・学校・学年・特記のテーブル */}
                                </div>
                            </div>
                        )}
                        {/* ユーザー管理画面など */}
                    </main>
                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
</body>
</html>
